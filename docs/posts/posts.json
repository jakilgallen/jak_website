[
  {
    "path": "posts/2022-03-13-spatial-analysis/",
    "title": "Report: Examining Population Trends of Steelhead Salmon, Jack Coho, and Coho fish from the Willamette Falls River Basin, Oregon from 2001-2010",
    "description": "A brief example of time series data visualization.",
    "author": [
      {
        "name": "Joseph Kilgallen ",
        "url": {}
      }
    ],
    "date": "2022-03-13",
    "categories": [],
    "contents": "\nOverview: The Willamette Basin\nReport Summary:\nIn this report I examine time series patterning of adult passage of steelhead salmon, jack coho, and coho fish recorded at the Willamette Falls fish ladder in Oregon from 2001- 2010. The report consists of three parts which will explore these data utilizing different approaches. Part 1 will present a time series visualization of the counts of each fish to explore patterning in population trends of these three fish species over time. Part 2 further explores seasonal changes in these fish populations, using ggseasons to plot seasonal shifts in fish recorded from 2001-2010. Part 3 presents a figure of annaual totals for fish passage for each of the three species. The report concludes with a summation of key takeaways and suggestions for future research. All data comes from the Columbia Basin Research’s Data access in real time (DART) program, but this report centers on fish counts recorded through the Willamette Falls Fishway. All data was recorded using video cameras and time lapsed video recorders to record adult fish passage.\n\nMap of the Willamette Basin, Oregon Credit: Keefer & Caudill 2010 & Location of Willamette Falls Credit: Clemens et al. 2012\nWillamette Falls Fish Ladder Diagram Credit: Northwest Power and Conservation Council taken from Baker & Graham’s 2012 ReportData Citation\nColumbia River DART, 2010. Data Courtesy of U.S. Army Corps of Engineers, NWD and Chelan, Douglas, and Grant County PUDs, Yakima Klickitat Fisheries Project, Colville Tribes Fish & Wildlife (OBMEP), Oregon Department of Fish & Wildlife, Washington Department of Fish & Wildlife.\n\nhide\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(broom)\nlibrary(lubridate)\nlibrary(ggpubr)\n\n# Time series packages\nlibrary(tsibble)\nlibrary(feasts)\nlibrary(fable)\n\n## reading in the data and cleaning up\nwill <- read_csv(here::here(\"data\", \"willamette.csv\")) %>% \n  janitor::clean_names()\n## counting by species for furture tabs\nwill_count <- will %>% \n  select(c(\"coho\", \"jack_coho\", \"steelhead\", \"date\")) %>% \n  replace(is.na(.), 0) %>% \n  mutate(date2 = lubridate::mdy(date)) %>% \n  group_by(date2,  steelhead, coho, jack_coho) %>% \n  summarize(total_count = sum(steelhead, coho, jack_coho))\n\n\n\nOriginal time series data\nObjective\nBelow we present a static graph displaying adult passage for coho, jack coho, and steelhead salmon separately. This figure allows us to analyze yearly population trends in these three species and gives us a good baseline understanding of how these populations have changed over the study period.\n\nhide\n## subset the data for this chart\n\n## want data just for coho, jack coho and salmon, \nwill_static <- will %>% \n  select(c(\"coho\", \"jack_coho\", \"steelhead\", \"date\")) \n## then  converting all NAs to zeros\nwill_static[is.na(will_static)] <- 0\n#class(will_static$date)\n\n# Currently R understands date variable as a character, need convert it into a time series data frame (a *tsibble*)\n# 1. Add a new column (date) that is the current month column converted to a time series class, yearmonth\n# 2. Convert the data frame to a tsibble, with that date column as the time index\nwill_ts <- will_static %>% \n  mutate(date2 = lubridate::mdy(date)) %>% \n  as_tsibble(key = NULL, index = date2) ## tells it to treat the data as a time series tibble  \n\n## first graph of all three on one\n# ggplot(data = will_ts, aes(x = date2)) +\n#   geom_line(aes(y =steelhead), color = \"green\") +\n#   geom_line(aes(y = jack_coho), color = \"red\") +\n#   geom_line(aes(y = coho), color = \"blue\") +\n#   theme_minimal() +\n#   scale_color_viridis_c() +\n#   labs()\n\n## now going to plot all separately and put together using ggarrange\nsteel_ts <- ggplot(data = will_ts, aes(x = date2)) +\n  geom_line(aes(y =steelhead), color = \"blue\")+\n  labs(y= \"Count\", subtitle = \"Steelhead Salmon\",\n       x = \"\")+\n  theme_minimal()\n\ncoho_ts <- ggplot(data = will_ts, aes(x = date2)) +\n  geom_line(aes(y =coho), color = \"red\")+\n  labs(y= \"Count\", subtitle = \"Coho\", x = \"\") +\n  theme_minimal()\n\njack_ts <- ggplot(data = will_ts, aes(x = date2)) +\n  geom_line(aes(y =jack_coho), color = \"green\") +\n  labs(y= \"Count\", subtitle = \"Jack Coho\", x = \"\")+\n  theme_minimal()\n\nggarrange(steel_ts, coho_ts, jack_ts, nrow = 3)\n\n\n\n\nFigure 1: Figure 1: Total Counts of Steelhead Salmon, Coho, and Jack Coho recorded from 2001-2010 at the Willamette River Basin, Oregon\n\n\n\nTime Series Plot Takeaways:\nExamining the time series plot of adult fish passage for Steelhead Salmon, Coho, and Jack Coho we report the following key takeaways:\nAcross nearly all years in which data was examined the abundance of steelhead salmon appears to be the highest, far exceeding both Coho and Jack Coho during these same time periods.\nIn terms of seasonality, we find no strong trend for both Coho and Jack Coho fish, though recorded observations of Choho appear to be increasing over the years, which may potentially bode well for this fish species. Inversely, Steelhead salmon appear to show strong seasonality with annual spikes in the recorded number of adult passages.\nIn general the abundance of Steelheads appears to have been the highest around 2002, 2004, and 2010, thus future research might want to examine why this species was so successful during these years. Recorded Coho populations are highest during the most recent years, i.e. 2009 & 2010 indicating that there may be positive developments ongoing for this species. Future work should look to isolate what factors have lead to an increase in relative Coho adundance to further promote these positive developments. We do not see any strong patterning in the Jack Coho, though they did have a surprising spike in recored adult passage at the end of 2008. This anomaly deserves explanation as overal Jack Coho abundance is relatively quite low.\nSeasonplots\nObjective\nIn this section I present a seasonplot for each species (coho, jack coho, steelhead) to examine seasonal changes over the recorded years (2001-2010)\n\nhide\n# steel_seas <- will_ts %>% \n#   gg_season(y = steelhead) + ## using ggseason function\n#   theme_minimal() +\n#   scale_color_viridis_c() +\n#   labs(x = \"\",\n#        y = \"Count\")\n# \n# coho_seas <-will_ts %>% \n#   gg_season(y = coho) + ## using ggseason function\n#   theme_minimal() +\n#   scale_color_viridis_c() +\n#   labs(x = \"\",\n#        y = \"coho\")\n# \n# jack_seas <-will_ts %>% \n#   gg_season(y = jack_coho) + ## using ggseason function\n#   theme_minimal() +\n#   scale_color_viridis_c() +\n#   labs(x = \"\",\n#        y = \"Jack Coho\")\n# \n# ggarrange(steel_seas, coho_seas, jack_seas, nrow = 3)\n\n## wrangling data for seasonplots\nwill_seas <- will_count %>% \n  as_tsibble(key = NULL, index = date2) %>% \n  pivot_longer(\"steelhead\":\"jack_coho\",\n               names_to = \"species\",\n               values_to = \"value\") %>% \n  mutate(species = \n         ifelse(species == \"steelhead\", \"Steelhead Salmon\",\n         ifelse(species == \"coho\", \"Coho\", \n         ifelse(species == \"jack_coho\", \"Jack Coho\", \n                \"\" )))) %>% \n  select(-total_count) %>% \n  rename(total_count = value)\n  \n\nall_seasonplot <- will_seas %>% \n  gg_season(y = total_count) +\n  labs(x = \"Date\", y = \"Count\", title = \"Total Counts of Coho, Jack Coho, and Steelhead Salmon\",\n       subtitle = \"Data collected at Willamette Falls River Basin from 2001-2010\") +\n  theme_minimal()\nall_seasonplot\n\n\n\n\nFigure 2: Figure 2: Seasonplots of Steelhead Salmon, Coho, and Jack Coho recorded from 2001-2010 at the Willamette River Basin, Oregon\n\n\n\nSeason Plot Takeaways\nFollowing the seasonal plots of each of the three species (seen above) we report the following takeaways:\nSeasonal patterns for Jack Coho and Coho appear to be somewhat similar. Across all recorded years we see a consistent spike in observed Jack Coho and Coho around October. This pattern appears highly seasonal as we see little to no recorded Coho or Jack Coho outside of this seasonal window. Reflecting findings from the Time series plot we see that Jack Coho had the highest recorded numbers in 2008, while Coho had the highest numbers in October of 2010.\nCompared to Jack Coho and Coho, the Steelhead salmon are far more abundant but have a much more variable seasonal pattern in recored passage. Instead of seeing a spike in recorded Steelhead during one period of the year, we instead see a trend in which passage increases steadily from the months of January- June, and then begins to decline through July and August, hitting a yearly low around October.\nDifferences in seasonality may reflect effects of competition between these three species as we see that Jack Coho and Coho seem to pass at the highest levels when Steelhead are least present (i.e. September-October Months). Future research might want to investigate the role of interspecies competition of adult passage trends.\nAnnual counts by species\nObjective\nBelow we visualize the total annual counts of adult passage for species Coho, Jack Coho, and Steelhead Salmon. The figure below shows shifts in annual population counts from 2001 to 2010.\n\nhide\n## first need to group the observations by species, extract year from the date column and then sum the species by year\nwill_count_yearly <- will_count %>% \n  pivot_longer(\"steelhead\":\"jack_coho\",\n               names_to = \"Species\",\n               values_to = \"value\") %>%\n  mutate(Species = \n         ifelse(Species == \"steelhead\", \"Steelhead Salmon\",\n         ifelse(Species == \"coho\", \"Coho\", \n         ifelse(Species == \"jack_coho\", \"Jack Coho\", \n                \"\" )))) %>% \n  mutate(year = as.Date(as.character(date2),format = \"%Y\")) %>%\n  group_by(year, Species) %>% \n  summarize(annual_total = sum(value))\n\n### now plotting all on same graph\nwill_count_yearly %>% \n  ggplot(aes(x = year, y = annual_total)) +\n  geom_line(aes(color= Species)) +\n  theme_minimal() +\n  scale_x_date(date_labels = \"%Y\") +\n  labs(\n    x = \"Year\",\n    y = \"Count\"\n  )\n\n\n\n\nFigure 3: Figure 3: Graph of Steelhead Salmon, Coho, and Jack Coho total recorded populations by year from 2001-2010\n\n\n\nAnnual Count Takeaways\nCounts for the Coho population were marginally greater then Jack Coho across all years, but far lower then Steelhead salmon across nearly all years (in exception of 2009). In general the Coho population fluctuated from around 5,000- 8,000 individuals from 2002- late 2007, then seeing a spike in the recorded population from 2008 on. Further work should investigate what lead to the population spike in 2008.\nCounts for the Jack Coho population are consistently lower then both Coho and Steelhead salmon across all years of data collection. Aside from a small increase in 2008 the population trend stays relatively flat with no great increases or decreases in counts. At the least abundance relative to the other 2 species the Jack Coho warrant further investigation to understand what is limiting their population growth.\nIn general Steelhead Salmon appear to be the most abundant species, but they have also seens some of the greatest shifts in recored adult passage across the years. Steelhead count was the greatest in 2002 and has seens signficant reductions from 2006-2009, it appears the population is returning to greater abundance in later 2009- 2010 but this remains to be seen.\n\n\n\n",
    "preview": "posts/2022-03-13-spatial-analysis/spatial-analysis_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-03-13T15:27:37-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-03-13-textanalysis/",
    "title": "Textual Analysis: The Meditations by Marcus Aurelius",
    "description": "A brief example of my textual analysis skills.",
    "author": [
      {
        "name": "Joseph Kilgallen ",
        "url": {}
      }
    ],
    "date": "2022-03-13",
    "categories": [],
    "contents": "\nOverview\nMarcus Aurelius- Crook, John Anthony. “Marcus Aurelius”. Encyclopedia Britannica, 10 Dec. 2021, https://www.britannica.com/biography/Marcus-Aurelius-Roman-emperor. Accessed 10 March 2022.This report presents textual visualizations and sentiment analysis of the famous ’Meditations\" by the philosopher king of Rome Marcus Aurelius. The report is split into three sections. In the first section I clean the data, put it into tidy, and remove all material other then the 3 books so that their content can be analyzed. In the second section I present two visualizations of the most common words by book number. Finally, the third section presents a sentiment analysis to determine how the sentiment differs across books using the AFINN lexicon.\nData Citation\nAurelius, M. (2003). The Meditations: A New Translation. Random House.\n\nhide\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)\nlibrary(tidyverse)\nlibrary(tidytext)\nlibrary(textdata)\nlibrary(pdftools)\nlibrary(ggwordcloud)\n\n## Reading in the data- Meditations by Marcus Aurelius\nmeditations_text <- pdf_text(here::here('data', 'meditations.pdf'))\n\n\n\n\nhide\n#converting into a data frame,  wrangling with the tidyverse, \nmed_lines <- data.frame(meditations_text) %>% ## convert to data frame\n  mutate(page = 1:n()) %>%\n  mutate(text_full = str_split(meditations_text, pattern = '\\\\n')) %>% \n  unnest(text_full) %>% \n  mutate(text_full = str_trim(text_full)) \n\n\n# Break it up by chapter, and do some analyses. \n# Adding a new column that contains the Book number (so we can use this as a grouping variable later on).\n# Using `str_detect()` to look for any cells in \"text_full\" column that contains the string \"Book\", and if it does, the new column will contain that book number:\nmed_books <- med_lines %>% \n  slice(-(1:1432)) %>% # cutting out all intro stuff to just analyze Marcus Aurelius's portion of the writing\n  mutate(book = ifelse(str_detect(text_full, \"Book\"), text_full, NA)) %>%  \n  fill(book, .direction = 'down') %>% ## fills the NAs in chapter with the values above\n  separate(col = book, into = c(\"bo\", \"no\"), sep = \" \") %>% # tells it to break apart the book column into two columns as specified and to separate by a space\n  mutate(book = as.numeric(as.roman(no))) \n## Noticed note section at end still attached want to remove so can just analyze by book\nmed_books_clean <- med_books %>% \n  slice(-(3795:4393))\n# tail(med_books_clean)\n\n\n## Now removing stop words using `tidyr::anti_join()`, which will *omit* any words in `stop_words` from `hobbit_tokens`.\nmed_words <- med_books_clean %>% \n  unnest_tokens(word, text_full) %>% \n  select(-meditations_text)\n\nmed_words_clean <- med_words %>% \n  anti_join(stop_words, by = 'word') # tells it to remove words from the hobbit_words data frame looking specifically in the word column and filtering out words that match with the stop_words\n\n## can do quick word count by book\nmed_counts <- med_words_clean %>% \n  count(book, word)\n\n\n\n1. Vizualizations of Common Words from Books 1-3\nIn this section I look at the top 5 words within each book and present a graph displaying these comparisons by book. I then create and present a wordcloud of the top 100 words used from all three of the books.\n\nhide\n## Looking at top 5 words\ntop_5_words <- med_counts %>% \n  drop_na() %>% \n  group_by(book) %>% \n  arrange(-n) %>% \n  slice(1:5) %>%\n  ungroup()\n\n# Graph of most common 5 words from each chapter\nggplot(data = top_5_words, aes(x = n, y = word, fill = book)) +\n  geom_col() +\n  scale_fill_viridis_c() +\n  facet_wrap(~book, scales = \"free\") +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(x = \"Total Count\", y = \"5 Most Common Words\", title = \"5 Most Common Words utilized across Books 1-3\",\n       subtitle = \"The Meditations by Marcus Aurelius\")\n\n\n\n\n\nhide\n## also going to make a wordcloud\ntop100 <- med_counts %>%\n  arrange(-n) %>%  ## tells it to arrange from highest to lowest of n\n  slice(1:100) # then tells it to just take the top 100 rows\n\ntop100_cloud <- ggplot(data = top100, aes(label = word)) +\n  geom_text_wordcloud(aes(color = n, size = n), shape = \"circle\") +\n  scale_size_area(max_size = 6) +\n  scale_color_gradientn(colors = c(\"darkgreen\",\"blue\",\"purple\")) +\n  theme_minimal() +\n  labs(title = \"100 Most Common Words from all three Books\")\n\ntop100_cloud\n\n\n\n\nTakeaways Word Count and Cloud\nAcross the three books there is a surprising amount of commonality at least in the top 5 words for each, with ‘people’, ‘nature’ and ‘life’ coming out as some of the most common words in at least 2 of the chapters.\nThis is reflected by the word cloud in which we see the most common words over all three books to be nature, people, mind, and life. These results make sense as the vast majority of the book discusses how people can live intentionally controlling their mind to live as nature intended.\n2. Sentiment analysis of ‘The Meditations’ using AFINN lexicon\nIn this section I present a sentiment analysis of The Meditations comparing how sentiments differ across each of the three books using the AFINN lexicon. The AFINN lexicon assigns words with a score that runs between -5 and 5, with negative scores indicating negative sentiment and positive scores indicating positive sentiment.\n\nhide\n## getting afinn \n#get_sentiments(lexicon = \"afinn\")\n# Let's look at the pretty positive words:\nafinn_pos <- get_sentiments(\"afinn\") %>% \n  filter(value %in% c(3,4,5))\n##lets get negative tehehehe muahhahah\nafinn_neg <- get_sentiments(\"afinn\") %>% \n  filter(value %in% c(-4,-5))\n\n## Performing Sentiment Analysis\nmed_afinn <- med_words_clean %>% \n  inner_join(get_sentiments(\"afinn\"), by = 'word')\n\nafinn_counts <- med_afinn %>% \n  drop_na() %>% \n  count(book, value)\n\n# Plot them: \nggplot(data = afinn_counts, aes(x = value, y = n, fill = book)) +\n  geom_col(colour = \"black\") +\n  facet_wrap(~book) +\n  scale_fill_viridis_c() +\n  labs(x = \"AFINN Value (from -5 = most negative to 5 = most positive)\", y = \"Total Count\", \n       title = \"Sentiment Values for Books 1-3\", subtitle = \"The Meditations by Marcus Aurelius\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\nhide\n# Find the mean afinn score by chapter: \nafinn_means <- med_afinn %>% \n  drop_na() %>%\n  group_by(book) %>% \n  summarize(mean_afinn = mean(value))\n\nggplot(data = afinn_means, \n       aes(x = fct_rev(factor(book)),\n           y = mean_afinn, fill = book)) +\n           # y = fct_rev(as.factor(chapter)))) +\n  geom_col() +\n  coord_flip() +\n  scale_fill_viridis_c() +\n  labs(x = \"Book Number\", y = \"Mean AFINN Value\", \n       title = \"Mean AFINN Values for Books 1-3\", subtitle = \"From The Meditations by Marcus Aurelius\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\nTakeaways Sentiment Analysis\nLooking at the figures above presenting results of the AFINN sentiment analysis several trends can be noted:\nIn general book 3 has far more words then the other 2 books both positive and negative. This is logically consistent as book 3 is by far the lengthiest of the three.\nBook 1 has the most positive mean value, Book 2 has the least positive mean value, and book 3 falls right in the middle. But overall none of the books are strongly positive or negative but instead fall largely in the middle. This is fitting for the stoic as much of Aurelius’s writing centers around the duality of existence i.e. the positive and negative. Thus there are many passages that contain a roughly equal amount of both ‘positive’ and ‘negative’ words.\n\n\n\n",
    "preview": "posts/2022-03-13-textanalysis/textanalysis_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-03-13T15:34:20-07:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-01-23-welcome/",
    "title": "Model Selection: Analysis Example",
    "description": "See here for an example of a report I have done using AIC and K-fold cross-validation for model selection.",
    "author": [
      {
        "name": "Joseph Kilgallen ",
        "url": {}
      }
    ],
    "date": "2022-01-23",
    "categories": [],
    "contents": "\nReport Overview\nThis report explores the relationship between O2 saturation of seawater off California’s coast and several physical and chemical variables using multiple linear regression. Within the report we formulate models to predict 02 saturation and then use AIC and 10-fold cross validation to determine the best model for the existing data. All data comes from the California Current system, a hydrographic time-series data set ongoing since 1949.\nData citation: CalCOFI data are available for use without restriction. Data downloaded from https://calcofi.org/ccdata.html. Accessed 1/10/2022.\nSetup\n\nhide\nknitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)\nlibrary(here)\nlibrary(tidyverse)\nlibrary(AICcmodavg)\nlibrary(equatiomatic)\nlibrary(broom)\nlibrary(jtools)\nlibrary(caret)\nlibrary(survival)\nlibrary(kimisc)\nlibrary(kableExtra)\n\n\n\n\nhide\nseawater <- read_csv(here(\"data\", \"calcofi_seawater_samples.csv\"),\n                     show_col_types = FALSE)\n\n\n\nModel Creation\nCreating two models one modeling oxygen saturation as a function of water temperature, salinity, and phosphate concentration and the other modeling oxygen saturation as a function of water temp, salinity, phosphate concentration, and depth.\n\nhide\n## Going to create the two models\n## Model 1--- Oxygen saturation as a function of water temperature, salinity, and phosphate concentration\nf1 <- o2sat~ t_deg_c + salinity + po4u_m\nmdl1 <- lm(formula = f1, data = seawater)\n# Coefficients:\n#             Estimate Std. Error t value Pr(>|t|)    \n# (Intercept) 195.7345    93.9380   2.084   0.0398 *  \n# t_deg_c      -0.4700     0.3902  -1.205   0.2313    \n# salinity     -2.1350     2.9344  -0.728   0.4686    \n# po4u_m      -38.4778     2.5207 -15.265   <2e-16 ***\n# Multiple R-squared:  0.9554,  Adjusted R-squared:  0.954 \n# F-statistic: 685.5 on 3 and 96 DF,  p-value: < 2.2e-16\n\n## Model 2--- Oxygen saturation as a function of water temp, salinity, phosphate concentration, and depth.\nf2 <- o2sat~ t_deg_c + salinity + po4u_m + depth_m\nmdl2 <- lm(formula = f2, data = seawater)\n# Coefficients:\n#              Estimate Std. Error t value Pr(>|t|)    \n# (Intercept) 144.06686   95.36730   1.511   0.1342    \n# t_deg_c      -0.74981    0.40494  -1.852   0.0672 .  \n# salinity     -0.43945    2.98897  -0.147   0.8834    \n# po4u_m      -37.71159    2.50113 -15.078   <2e-16 ***\n# depth_m      -0.03196    0.01497  -2.135   0.0354 *  \n# Multiple R-squared:  0.9574,  Adjusted R-squared:  0.9557 \n# F-statistic: 534.3 on 4 and 95 DF,  p-value: < 2.2e-16\n\n\n\nModel Selection pt.1 AIC\nBelow we compare the two models using the Aikeike Information Criterion (AIC).\n\nhide\n## Now going to compare the two models using the AICcmodavg package\nmodel_list <- nlist(mdl1, mdl2)\n## According to the AIC Model 2 is currently the best fit\n\n\n# Add a column to the table with variable names\n# modelsummary(list(mdl1, mdl2), fmt = 2) %>% \n#   kabl\naic_table <- AICcmodavg::aictab(model_list, modnames = c(\"Model 1\", \"Model 2\"),\n       second.ord = TRUE,\n       sort = TRUE,\n       )\naic_table %>% \n  kbl(caption = \"Model Ranking based on AIC\") %>% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n\n\n\nTable 1: Model Ranking based on AIC\n\n\n\n\nModnames\n\n\nK\n\n\nAICc\n\n\nDelta_AICc\n\n\nModelLik\n\n\nAICcWt\n\n\nLL\n\n\nCum.Wt\n\n\n2\n\n\nModel 2\n\n\n6\n\n\n616.6048\n\n\n0.000000\n\n\n1.0000000\n\n\n0.7703216\n\n\n-301.8508\n\n\n0.7703216\n\n\n1\n\n\nModel 1\n\n\n5\n\n\n619.0251\n\n\n2.420256\n\n\n0.2981592\n\n\n0.2296784\n\n\n-304.1934\n\n\n1.0000000\n\n\nAIC Summary Results: Based on resultant AIC scores, it appears that model 2 may be the better fit for predicting oxygen saturation from our data. Comparing AIC scores for model 1 (AIC = 619) and model 2 (AIC = 616), we find that model 2 has an overall lower AIC score indicating that it provides a better balance of explanatory power and simplicity compared to model 1. Both models have similar r-squared values around 0.95, thus given AIC scores model 2 appears to be the best fit.\nModel Selection pt.2 10-fold cross-validation\nBelow we use an alternative methodology to determine model selection, utilizing a 10-fold cross-validation method.\n\nhide\nset.seed(123)\n\ntr_ctrl <- trainControl(method = 'cv', number = 10) # cv tells cross-validation, number = # of folds\ntr_ctrl_repeated<- trainControl(method = 'repeatedcv', \n                                number = 10, repeats =10) # now this tells it to do repeated tests \n\n## train the model, the below function tells us using formula f1 and the specified data, build a lm \n ## now running with repeated for model1\n model1<- train(f1, data = seawater,\n                method = 'lm',\n                trControl = tr_ctrl_repeated)\n # RMSE      Rsquared   MAE     \n #  4.891453  0.9591882  3.503781\n\n  ## now running with repeated for model2\n model2<- train(f2, data = seawater,\n                method = 'lm', \n                trControl = tr_ctrl_repeated)\n # RMSE      Rsquared   MAE     \n #  4.808869  0.9614641  3.492599\n\n ## Making a table of results\n Model <- c(\"Model 1\", \"Model 2\")\n RMSE <- c(4.891453, 4.808869)\n R_Squared <- c(0.9591882, 0.9614641)\n MAE <- c(3.503781, 3.492599)\n k_fold_data <- data_frame(Model, RMSE, R_Squared)\n \n k_fold_data %>% \n   kbl(caption = \"Model Ranking based on 10-Fold Cross Validation\") %>% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n\n\n\nTable 2: Model Ranking based on 10-Fold Cross Validation\n\n\nModel\n\n\nRMSE\n\n\nR_Squared\n\n\nModel 1\n\n\n4.891453\n\n\n0.9591882\n\n\nModel 2\n\n\n4.808869\n\n\n0.9614641\n\n\n10-fold Cross-Validation Summary Results: Based on results of our 10-fold cross-validation tests, we find that model 2 appears to be best fit; reconfirming previous findings from the AIC. Comparing RMSE’s for model 1 and 2 (see table 2) we find that while both models have similar R-squared values, model 2 has a lower relative RMSE, indicating it is better fit to our data.\nFinal Parametized Model predicting Oxygen Saturation\n\nhide\nfinal_mdl <- lm(f2, data = seawater)\n\n\n\nConclusion: Taking into account results of both the AIC and 10-fold cross validation, we determine that model 2 is the best fit model for the data. Model 2 had the relatively lowest AIC score as well as RMSE, indicating that it is superior in it’s simplicity, explanatory power, and data fit in comparison to model 1.\nOur final model: \\[\n\\begin{aligned}\n\\operatorname{o2sat} &= \\alpha + \\beta_{1}(\\operatorname{t\\_deg\\_c}) + \\beta_{2}(\\operatorname{salinity}) + \\beta_{3}(\\operatorname{po4u\\_m})\\ + \\\\\n&\\quad \\beta_{4}(\\operatorname{depth\\_m}) + \\epsilon\n\\end{aligned}\n\\]\nAnd with parameters: \\[\n\\begin{aligned}\n\\operatorname{\\widehat{o2sat}} &= 144.07 - 0.75(\\operatorname{t\\_deg\\_c}) - 0.44(\\operatorname{salinity}) - 37.71(\\operatorname{po4u\\_m})\\ - \\\\\n&\\quad 0.03(\\operatorname{depth\\_m})\n\\end{aligned}\n\\]\n\n\n\n",
    "preview": {},
    "last_modified": "2022-03-13T15:16:06-07:00",
    "input_file": {}
  }
]
